name: install dotfiles

on: [push]

jobs:
  build:

    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v2
    - name: Run help command.
      run: |
        curl https://raw.githubusercontent.com/ryuta69/dotfiles/master/install.sh | /bin/bash -s -- --help
    - name: Initialize
      run: |
        brew tap homebrew/bundle
        brew install zsh
        sudo sh -c 'echo /usr/local/bin/zsh >> /etc/shells'
        sudo chsh -s /usr/local/bin/zsh
        chmod 755 /usr/local/share/zsh
        chmod 755 /usr/local/share/zsh/site-functions
        mkdir -p ~/.ssh
        mkdir -p ~/work
    - name: Install bundle
      run: |
        ./bundle/install.zsh --force --test
    - name: Install dotfiles
      run: |
        ./dotfiles/install.zsh --force
    - name: Install macos system setting
      run: |
        ./system/install.zsh --force --test
